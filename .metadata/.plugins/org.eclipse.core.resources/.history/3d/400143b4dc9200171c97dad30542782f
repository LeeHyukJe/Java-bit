package ch16;

import java.net.*;
import java.io.*;
import java.util.*;

public class ClientTest {

	public static void main(String[] args) {
		// TODO Auto-generated method stub

		try {
			String serverIP = "192.168.104.26";
			Socket socket = new Socket(serverIP, 7777);
			Thread sender = new Thread(new ClientSender(socket,args[0]));
			Thread receive = new Thread(new ClientReceive(socket));

			sender.start();
			receive.start();
		} catch (Exception e) {}
	}

}

class ClientSender implements Runnable {
	Socket socket;
	DataOutputStream dos;
	String name;

	ClientSender(Socket socket, String name) {
		this.socket = socket;
		try {
			this.name = name;
			dos = new DataOutputStream(socket.getOutputStream());
		} catch (Exception e) {}
	}

	public void run() {
		Scanner sc = new Scanner(System.in);
		
		try {
			if(dos!=null) {
				dos.writeUTF(name);
			}
			
			while (dos != null) {
				dos.writeUTF("[" + name + "]" + sc.nextLine());
			}
		} catch (Exception e) {}
	}
}

class ClientReceive implements Runnable {
	Socket socket;
	DataInputStream dis;
	
	
	ClientReceive(Socket socket){
		this.socket=socket;
		try {
			dis=new DataInputStream(socket.getInputStream());
		}catch(Exception e) {}
	}

	public void run() {
		try {
			while(dis!=null) {
				System.out.println(dis.readUTF());
			}
		}catch(Exception e) {}
	}
}
